import{h as j,c as N,r as o,j as e,u as f,i as C,B as q}from"./index-D-tOdqmH.js";import{u as v}from"./useMutation-BQtBaTbt.js";import{D as F}from"./DeleteModal-CB8DEC7q.js";import{K as b,h as g}from"./dialog-rlaXgZka.js";import"./with-selector--Zn5bBfh.js";const S=({isOpen:r,closeModal:n,book:s})=>{const d=j(),l=N(),[a,x]=o.useState({title:"",author:"",category:"",price:"",quantity:"",description:"",image:""});o.useEffect(()=>{s&&x({title:s?.title||"",author:s?.author||"",category:s?.category||"",price:s?.price??"",quantity:s?.quantity??"",description:s?.description||"",image:s?.image||""})},[s]);const{mutateAsync:u,isPending:m}=v({mutationFn:async i=>{const{data:c}=await d.patch(`/books/${s?._id}`,i);return c},onSuccess:()=>{l.invalidateQueries({queryKey:["inventory"]}),n()}}),t=i=>{const{name:c,value:h}=i.target;x(y=>({...y,[c]:h}))},p=async i=>{i.preventDefault();const c={title:a.title.trim(),author:a.author.trim(),category:a.category.trim(),price:Number(a.price),quantity:Number(a.quantity),description:a.description.trim(),image:a.image.trim()};await u(c)};return e.jsx(b,{appear:!0,show:r,as:o.Fragment,children:e.jsxs(g,{as:"div",className:"relative z-50",onClose:n,children:[e.jsx(b.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(b.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(g.Panel,{className:"w-full max-w-xl transform rounded-xl bg-white p-6 text-left align-middle shadow-xl",children:[e.jsx(g.Title,{className:"text-lg font-semibold",children:"Update Book"}),e.jsxs("form",{onSubmit:p,className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"form-control",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Title"})}),e.jsx("input",{name:"title",value:a.title,onChange:t,className:"input input-bordered",required:!0})]}),e.jsxs("label",{className:"form-control",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Author"})}),e.jsx("input",{name:"author",value:a.author,onChange:t,className:"input input-bordered",required:!0})]}),e.jsxs("label",{className:"form-control",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Category"})}),e.jsx("input",{name:"category",value:a.category,onChange:t,className:"input input-bordered"})]}),e.jsxs("label",{className:"form-control",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Price"})}),e.jsx("input",{type:"number",step:"0.01",name:"price",value:a.price,onChange:t,className:"input input-bordered",required:!0})]}),e.jsxs("label",{className:"form-control",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Quantity"})}),e.jsx("input",{type:"number",name:"quantity",value:a.quantity,onChange:t,className:"input input-bordered",required:!0})]}),e.jsxs("label",{className:"form-control md:col-span-2",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Image URL"})}),e.jsx("input",{name:"image",value:a.image,onChange:t,className:"input input-bordered"})]}),e.jsxs("label",{className:"form-control md:col-span-2",children:[e.jsx("div",{className:"label",children:e.jsx("span",{className:"label-text",children:"Description"})}),e.jsx("textarea",{name:"description",value:a.description,onChange:t,className:"textarea textarea-bordered",rows:3})]})]}),e.jsxs("div",{className:"mt-2 flex justify-end gap-2",children:[e.jsx("button",{type:"button",className:"btn",onClick:n,disabled:m,children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?"Updating...":"Update"})]})]})]})})})})]})})},D=({book:r})=>{let[n,s]=o.useState(!1);const[d,l]=o.useState(!1),a=j(),x=N(),{user:u}=f(),{mutateAsync:m}=v({mutationFn:async()=>a.delete(`/books/${r._id}`),onSuccess:()=>{x.invalidateQueries({queryKey:["inventory",u?.email]})}});function t(){s(!0)}function p(){s(!1)}const{image:i,name:c,category:h,quantity:y,price:w}=r;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"shrink-0",children:e.jsx("div",{className:"block relative",children:e.jsx("img",{alt:"profile",src:i,className:"mx-auto object-cover rounded h-10 w-15 "})})})})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 ",children:c})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 ",children:h})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 ",children:y})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsxs("p",{className:"text-gray-900 ",children:["$ ",w]})}),e.jsxs("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:[e.jsxs("span",{onClick:t,className:"relative cursor-pointer inline-block px-3 py-1 font-semibold text-green-900 leading-tight",children:[e.jsx("span",{"aria-hidden":"true",className:"absolute inset-0 bg-red-200 opacity-50 rounded-full"}),e.jsx("span",{className:"relative",children:"Delete"})]}),e.jsx(F,{isOpen:n,closeModal:p,onConfirm:async()=>{await m(),p()}})]}),e.jsxs("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:[e.jsxs("span",{onClick:()=>l(!0),className:"relative cursor-pointer inline-block px-3 py-1 font-semibold text-green-900 leading-tight",children:[e.jsx("span",{"aria-hidden":"true",className:"absolute inset-0 bg-green-200 opacity-50 rounded-full"}),e.jsx("span",{className:"relative",children:"Update"})]}),e.jsx(S,{isOpen:d,closeModal:()=>l(!1),book:r})]})]})},k=()=>{const{user:r}=f(),n=j(),{data:s=[],isLoading:d}=C({queryKey:["inventory",r?.email],queryFn:async()=>(await n(`/my-inventory/${r?.email}`)).data});return d?e.jsx(q,{}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"container mx-auto px-4 sm:px-8",children:e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:e.jsx("div",{className:"inline-block min-w-full shadow rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full leading-normal",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Image"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Name"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Category"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Price"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Quantity"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Delete"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Update"})]})}),e.jsx("tbody",{children:s.map(l=>e.jsx(D,{book:l},l._id))})]})})})})})})};export{k as default};
