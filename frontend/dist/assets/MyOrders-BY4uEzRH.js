import{j as e,r as o,h as x,u as w,i as v,B as C}from"./index-D-tOdqmH.js";import{D as k}from"./DeleteModal-CB8DEC7q.js";import{R as F}from"./ReviewForm-s47_saQy.js";import{K as c,h as n}from"./dialog-rlaXgZka.js";import"./with-selector--Zn5bBfh.js";const R=({isOpen:l,closeModal:s,bookId:t,onReviewed:r})=>e.jsx(c,{appear:!0,show:l,as:o.Fragment,children:e.jsxs(n,{as:"div",className:"relative z-50",onClose:s,children:[e.jsx(c.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e.jsx("div",{className:"fixed inset-0 bg-black/30"})}),e.jsx("div",{className:"fixed inset-0 overflow-y-auto",children:e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsx(c.Child,{as:o.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:e.jsxs(n.Panel,{className:"w-full max-w-lg transform rounded-xl bg-white p-6 text-left align-middle shadow-xl",children:[e.jsx(n.Title,{className:"text-lg font-semibold",children:"Write a Review"}),e.jsx("div",{className:"mt-4",children:e.jsx(F,{bookId:t,onReviewAdded:()=>{r&&r(),s()}})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{className:"btn",onClick:s,children:"Close"})})]})})})})]})}),O=({order:l,refetch:s})=>{let[t,r]=o.useState(!1);const[i,a]=o.useState(!1),d=()=>r(!1),m=x(),{_id:p,image:h,name:b,category:u,price:y,quantity:g,status:j,bookId:f}=l||{},N=async()=>{try{await m.delete(`/orders/${p}`),d(),s&&s()}catch{alert("Failed to cancel order")}};return e.jsxs("tr",{children:[e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"shrink-0",children:e.jsx("div",{className:"block relative",children:e.jsx("img",{alt:"profile",src:h,className:"mx-auto object-cover rounded h-10 w-15 "})})})})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900",children:b})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900",children:u})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsxs("p",{className:"text-gray-900",children:["$",y]})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900",children:g})}),e.jsx("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900",children:j})}),e.jsxs("td",{className:"px-5 py-5 border-b border-gray-200 bg-white text-sm space-x-2",children:[e.jsxs("button",{onClick:()=>r(!0),className:"relative disabled:cursor-not-allowed cursor-pointer inline-block px-3 py-1 font-semibold text-lime-900 leading-tight",children:[e.jsx("span",{className:"absolute cursor-pointer inset-0 bg-red-200 opacity-50 rounded-full"}),e.jsx("span",{className:"relative cursor-pointer",children:"Cancel"})]}),e.jsxs("button",{onClick:()=>a(!0),className:"relative inline-block px-3 py-1 font-semibold text-blue-900 leading-tight",children:[e.jsx("span",{className:"absolute inset-0 bg-blue-200 opacity-60 rounded-full"}),e.jsx("span",{className:"relative",children:"Review"})]}),e.jsx(k,{isOpen:t,closeModal:d,onConfirm:N}),e.jsx(R,{isOpen:i,closeModal:()=>a(!1),bookId:f,onReviewed:s})]})]})},I=()=>{const{user:l}=w(),s=x(),{data:t=[],isLoading:r,refetch:i}=v({queryKey:["orders",l?.email],queryFn:async()=>(await s("/my-orders")).data});return console.log(t),r?e.jsx(C,{}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"container mx-auto px-4 sm:px-8",children:e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:e.jsx("div",{className:"inline-block min-w-full shadow rounded-lg overflow-hidden",children:e.jsxs("table",{className:"min-w-full leading-normal",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Image"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Name"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Category"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Price"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Quantity"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Status"}),e.jsx("th",{scope:"col",className:"px-5 py-3 bg-white  border-b border-gray-200 text-gray-800  text-left text-sm uppercase font-normal",children:"Action"})]})}),e.jsx("tbody",{children:t.map(a=>e.jsx(O,{order:a,refetch:i},a._id))})]})})})})})})};export{I as default};
